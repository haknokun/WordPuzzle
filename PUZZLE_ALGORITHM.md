# 퍼즐 생성 알고리즘

## 개요

`PuzzleGeneratorService.java`에서 한국어 십자말풀이 퍼즐을 생성하는 알고리즘입니다.

## 생성 과정

### 1단계: 초기화

- `gridSize x gridSize` 크기의 빈 그리드(`char[][]`) 생성
- DB에서 길이 2 ~ gridSize 사이의 후보 단어들을 가져옴
- 후보 단어 리스트를 랜덤하게 셔플

### 2단계: 첫 번째 단어 배치

- 그리드 **중앙**에 **가로(ACROSS)** 방향으로 배치
- 시작 위치 계산:
  - `row = gridSize / 2`
  - `col = (gridSize - 단어길이) / 2`

### 3단계: 나머지 단어 배치

`while` 루프로 목표 단어 수에 도달할 때까지 반복:

1. 랜덤하게 후보 단어 선택
2. `findBestPlacement()`로 최적 배치 위치 탐색
3. 유효한 위치가 있으면 배치, 없으면 재시도
4. 최대 100회 실패 시 현재까지 배치된 단어로 종료

### 4단계: 최적 배치 탐색 (`findBestPlacement`)

```
그리드 전체 순회:
  이미 글자가 있는 셀 발견 시:
    새 단어의 각 글자와 비교:
      같은 글자가 있으면:
        → 가로(ACROSS) 배치 가능 여부 검사
        → 세로(DOWN) 배치 가능 여부 검사

모든 유효한 배치 중 "교차점이 가장 많은" 배치 선택
```

### 5단계: 배치 가능 여부 검사 (`canPlaceWord`)

다음 조건을 모두 만족해야 배치 가능:

| 조건 | 설명 |
|------|------|
| 경계 검사 | 그리드 범위 내인지 |
| 앞뒤 빈칸 | 단어 시작 전/끝 후에 다른 글자가 없어야 함 |
| 글자 충돌 | 기존 글자와 새 글자가 일치해야 함 |
| 평행 인접 | 빈 셀에 배치 시 위/아래(가로) 또는 좌/우(세로)에 다른 단어가 인접하면 안 됨 |
| 교차 필수 | 최소 1개 이상 기존 글자와 교차해야 함 |

### 6단계: 번호 부여

- 가로/세로 단어를 분리
- 각각 위→아래, 왼쪽→오른쪽 순서로 정렬
- **가로와 세로에 독립적인 번호 체계** 부여 (각각 1, 2, 3...)

### 7단계: 셀 그리드 변환

- `char[][]` → `List<List<PuzzleCell>>` 변환
- 각 셀에 `acrossNumber`, `downNumber` 할당 (단어 시작 위치인 경우)

## 핵심 특징

- **그리디 알고리즘**: 교차점이 많은 배치 우선 선택
- **최대 시도 제한**: 100회 실패 시 현재까지 결과 반환
- **이중 번호 체계**: 한 셀에 가로/세로 번호가 동시에 존재 가능

## 관련 파일

- `PuzzleGeneratorService.java`: 메인 알고리즘
- `PuzzleCell.java`: 그리드 셀 DTO
- `PuzzleWord.java`: 배치된 단어 정보 DTO
- `PuzzleResponse.java`: API 응답 DTO
